#!/bin/bash
SCRATCHDIRECTORY=`pwd`
GNUPLOTDIRECTORYCOMMON=$SCRATCHDIRECTORY/GPFILES
OUTDIRECTORY="ResultsThermopower"
SPECSCOMMON=$SCRATCHDIRECTORY/SPECSFILES
JUNCTIONLIST="PPV1TRIMTRIM PPV2TRIMTRIM PPV3TRIMTRIM PPV4TRIMTRIM PPV5TRIMTRIM PPV1TRIMTRIMFAR PPV2TRIMTRIMFAR PPV3TRIMTRIMFAR PPV4TRIMTRIMFAR PPV5TRIMTRIMFAR"
BIASLIST="0"
GNUPLOTFILE="Makeplot.Seebeck.rungp"
GNUPLOTEXE="gnuplot"
mkdir $SCRATCHDIRECTORY/temp


echo SCRATCHDIRECTORY
echo $SCRATCHDIRECTORY


#############################################
#############################################
#############################################
#LOOP for LOCAL_M in 1 2 3 4 5
for LOCALDIR in $JUNCTIONLIST
do
cd $SCRATCHDIRECTORY/temp
echo "Launching Junction: " $LOCALDIR
cd $SCRATCHDIRECTORY/$LOCALDIR
echo "Target Directory: "  $SCRATCHDIRECTORY/$LOCALDIR
echo "Actual Directory: " `pwd`
#############################################
echo "Setting Out Directory: " $OUTDIRECTORY
mkdir $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY
cd    $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY
rm $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY/*.gif
rm $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY/*.ps
rm $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY/*.dat
rm $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY/*.pdf
#############################################
# BIAS LOOP
for BIAS  in  $BIASLIST
do
echo "Launching Junction: " $LOCALDIR" at bias " $BIAS
############################################# COMMON
cd $SCRATCHDIRECTORY/temp/
rm ./*
ln -s $GNUPLOTDIRECTORYCOMMON/*.setgp   $SCRATCHDIRECTORY/temp/
ln -s $GNUPLOTDIRECTORYCOMMON/*.rungp   $SCRATCHDIRECTORY/temp/
ln -s $GNUPLOTDIRECTORYCOMMON/*.plt     $SCRATCHDIRECTORY/temp/
cp $SPECSCOMMON/$LOCALDIR\.ingp   $SCRATCHDIRECTORY/temp/specs.ingp
cp $SPECSCOMMON/common.ingp       $SCRATCHDIRECTORY/temp/common.ingp

cp  $SCRATCHDIRECTORY/$LOCALDIR/$BIAS.DFT.Large.gp   $SCRATCHDIRECTORY/temp/0.DFT.Large.gp
cp  $SCRATCHDIRECTORY/$LOCALDIR/$BIAS.DFT+S.Large.gp $SCRATCHDIRECTORY/temp/0.DFT+S.Large.gp
cp  $SCRATCHDIRECTORY/$LOCALDIR/$BIAS.DFT.Small.gp   $SCRATCHDIRECTORY/temp/0.DFT.Small.gp
cp  $SCRATCHDIRECTORY/$LOCALDIR/$BIAS.DFT+S.Small.gp $SCRATCHDIRECTORY/temp/0.DFT+S.Small.gp

echo "Seebeck"
nohup $GNUPLOTEXE $GNUPLOTFILE  >  $SCRATCHDIRECTORY/temp/$BIAS.$LOCALDIR.Gnuplot.out
cp  $SCRATCHDIRECTORY/temp/$BIAS.$LOCALDIR.Gnuplot.out $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY/$BIAS.$LOCALDIR.Gnuplot.out
grep "Results T-S-ZTK"   $SCRATCHDIRECTORY/temp/$BIAS.$LOCALDIR.Gnuplot.out >> $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY/$BIAS.$LOCALDIR.Results.dat  
grep "Results T-S-ZTK"   $SCRATCHDIRECTORY/temp/$BIAS.$LOCALDIR.Gnuplot.out >> $SCRATCHDIRECTORY/Results.Thermopower.dat  
echo "Done"

cp   $SCRATCHDIRECTORY/temp/$LOCALDIR\SeebeckCoefficient\0.ps  $SCRATCHDIRECTORY/$LOCALDIR/$OUTDIRECTORY/$BIAS.$LOCALDIR.SeebeckCoefficient.ps

done
echo "Completed for Junction: "  $LOCALDIR
done

echo "Done"


